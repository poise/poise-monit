# Generated by Chef for <%= @new_resource.to_s %>

<%# If daemon_delay is nil/false we put the value on the command line with -d %>
<%- if @new_resource.daemon_delay -%>
SET DAEMON <%= @new_resource.daemon_interval %>
  <%- if @new_resource.daemon_delay > 0 -%>
  WITH START DELAY <%= @new_resource.daemon_delay %>
  <%- end -%>
<%- end -%>

SET PIDFILE <%= @new_resource.pidfile %>

<%- if @new_resource.logfile -%>
SET LOGFILE <%= @new_resource.logfile %>
<%- end -%>

<%- if @new_resource.var_path -%>
SET IDFILE <%= @new_resource.var_path %>/id
SET STATEFILE <%= @new_resource.var_path %>/state
<%- if @new_resource.event_slots && @new_resource.event_slots != 0 -%>
SET EVENTQUEUE BASEDIR <%= @new_resource.var_path %>/events<% if @new_resource.event_slots > 0 %> SLOTS <%= @new_resource.event_slots %><% end %>
<%- end -%>
<%- end -%>

<%# If httpd_port is nil, just do nothing. This will break other stuff. Oh well. %>
<%- if @new_resource.httpd_port -%>
SET HTTPD <%= @new_resource.httpd_is_unix? ? 'UNIXSOCKET' : 'PORT' %> <%= @new_resource.httpd_port %>
<%- if @new_resource.httpd_password %>
  ALLOW <%= @new_resource.httpd_username %>:<%= @new_resource.httpd_password %>
<%- else -%>
  ALLOW 0.0.0.0/0
<%- end -%>
<%- end -%>

INCLUDE <%= @new_resource.confd_path %>/*
